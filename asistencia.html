<html>
    <script src="https://cdn.jsdelivr.net/npm/jsonata/jsonata.min.js"></script>

    <script src="tea-block.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>
    <script>
        
        var enc
        var check
        function hash() {
            var json
       $.getJSON('https://sheets.googleapis.com/v4/spreadsheets/1DvqXaY0vYHuqVwGqNubevsXKWeboHfYIp8rOqyGLFO8/values/todayEvents?key=AIzaSyCHu7lPjGMgsv6X_U6FgL6atwHQ5Mhk_nY')
        .done(function(jsonurl){
            //Devuelve el hash de sheets
            var result = jsonata('$.values.({"congregacion": $[0],"enc": $[1]})[congregacion="Churruar√≠n"].enc').evaluate(jsonurl);
                   
            document.getElementById('hash').innerHTML = result;

           enc = result;

        })
        .fail(function(){
          //Hubo un error en la solicitud
          alert("Error al generar el hash")
        })
        
        };
        function url() {
            var url = decrypt(enc, document.getElementById('txclave').value);
            var urlCompleta = "https://youtube.com/embed/"+url;
           
            if(urlCompleta.match(/(?:youtu\.be\/|youtube\.com(?:\/embed\/|\/v\/|\/watch\?v=|\/user\/\S+|\/ytscreeningroom\?v=))([\w\-]{10,12})\b/))
            {
                //Es una url de youtube
                document.getElementById('url').innerHTML = urlCompleta;
            }
            else
            {
               //No es una url de youtube
                alert('Datos incorrectos');
            }
            
        }
    </script>
 <body>  
        <button onclick="hash()">obtener hash</button>
    <p id="hash"></p> <p id="crc"></p> 
      <input type="text" id="txclave" value=""></input>
     <button onclick="url()">obtener url</button>
   
    <p id="url"></p> <p id="crc2"></p> 
<form action="https://docs.google.com/forms/u/1/d/e/1FAIpQLSfqyPMNsylEjws1VkTpxbb7dc_jYlPsyCUkgqALWjI4l85RdQ/formResponse" target="_self" method="POST" id="mG61Hd">
Publicador
  <input type="text" name="entry.106585637" value=""></input>
  Espectadores
  <input type="text" name="entry.1056716961" ></input>
 Congregacion
  <input type="text" name="entry.1223281277"></input>
Clave
  <input type="text" name="entry.970010747"></input>
 Meta
  <input type="text" name="entry.1023303782"></input>
                                       
                     
            <input type="hidden" name="fvv" value="1">
            <input type="hidden" name="draftResponse" value="[null,null,&quot;-8112877041524363823&quot;]">
            <input type="hidden" name="pageHistory" value="0">
            <input type="hidden" name="fbzx" value="-8112877041524363823">
<input type="submit">Enviar</input>
</form>
   
<br>



</body>
</html>
